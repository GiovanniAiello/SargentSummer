(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     39896,       1262]
NotebookOptionsPosition[     36449,       1139]
NotebookOutlinePosition[     36803,       1155]
CellTagsIndexPosition[     36760,       1152]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.585077416316329*^9, 3.585077418850189*^9}}],

Cell[CellGroupData[{

Cell["Problem 5.3", "Section",
 CellChangeTimes->{{3.5850766971698017`*^9, 3.585076698584449*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["c", "t"], " ", "-", " ", "b"}], ")"}], "2"], " ", "+", 
     RowBox[{
      SubscriptBox["i", "t"], " ", "\[Gamma]", " ", 
      SubscriptBox["i", "t"]}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5850767036769333`*^9, 3.585076745368372*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", 
  RowBox[{"expr", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["c", "t"], "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", " ", 
        SubscriptBox["a", "t"]}], " ", "+", " ", 
       SubscriptBox["y", "t"], " ", "-", " ", 
       SubscriptBox["i", "t"]}], ")"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TeXForm", "[", 
  RowBox[{"expr", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["c", "t"], "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", " ", 
        SubscriptBox["a", "t"]}], " ", "+", " ", 
       SubscriptBox["y", "t"], " ", "-", " ", 
       SubscriptBox["i", "t"]}], ")"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.585076848592203*^9, 3.5850768881031017`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r", " ", 
       SubscriptBox["a", "t"]}], "-", "b", "-", 
      SubscriptBox["i", "t"], "+", 
      SubscriptBox["y", "t"]}], ")"}], "2"], "+", 
   RowBox[{"\[Gamma]", " ", 
    SubsuperscriptBox["i", "t", "2"]}]}], TraditionalForm]], "Print",
 CellChangeTimes->{{3.585076857703979*^9, 3.585076888369426*^9}, 
   3.5850774212659473`*^9}],

Cell["\\left(r a_t-b-i_t+y_t\\right){}^2+\\gamma  i_t^2", "Output",
 CellChangeTimes->{{3.585076882897949*^9, 3.5850768883713923`*^9}, 
   3.585077421267294*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", " ", "=", " ", 
  RowBox[{"Expand", "[", 
   RowBox[{"expr", " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["c", "t"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", " ", 
         SubscriptBox["a", "t"]}], " ", "+", " ", 
        SubscriptBox["y", "t"], " ", "-", " ", 
        SubscriptBox["i", "t"]}], ")"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5850767398314*^9, 3.585076823859275*^9}, {
  3.585077003102429*^9, 3.585077005926137*^9}, {3.58507712320525*^9, 
  3.585077136371277*^9}, {3.585077409216804*^9, 3.585077413393084*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", "b", " ", "r", " ", 
     SubscriptBox["a", "t"]}]}], "-", 
   RowBox[{"2", " ", "r", " ", 
    SubscriptBox["a", "t"], " ", 
    SubscriptBox["i", "t"]}], "+", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    SubsuperscriptBox["a", "t", "2"]}], "+", 
   RowBox[{"2", " ", "r", " ", 
    SubscriptBox["a", "t"], " ", 
    SubscriptBox["y", "t"]}], "+", 
   SuperscriptBox["b", "2"], "+", 
   RowBox[{"2", " ", "b", " ", 
    SubscriptBox["i", "t"]}], "-", 
   RowBox[{"2", " ", "b", " ", 
    SubscriptBox["y", "t"]}], "+", 
   RowBox[{"\[Gamma]", " ", 
    SubsuperscriptBox["i", "t", "2"]}], "-", 
   RowBox[{"2", " ", 
    SubscriptBox["i", "t"], " ", 
    SubscriptBox["y", "t"]}], "+", 
   SubsuperscriptBox["i", "t", "2"], "+", 
   SubsuperscriptBox["y", "t", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.58507674046488*^9, 3.585076790687354*^9}, 
   3.5850768243635483`*^9, 3.5850770066774597`*^9, {3.585077125223781*^9, 
   3.585077136823421*^9}, {3.585077410138527*^9, 3.585077423001802*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "f", "]"}]], "Input",
 CellChangeTimes->{{3.585078378901772*^9, 3.5850783814111423`*^9}}],

Cell["\<\
-2 b r a_t-2 r a_t i_t+r^2 a_t^2+2 r a_t y_t+b^2+2 b i_t-2 b y_t+\\gamma  \
i_t^2-2 i_t y_t+i_t^2+y_t^2\
\>", "Output",
 CellChangeTimes->{3.5850783818364277`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{"f", ",", " ", 
   SubscriptBox["y", "t"]}], "]"}]], "Input",
 CellChangeTimes->{{3.585077424201836*^9, 3.585077430655734*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["y", "t"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "r", " ", 
       SubscriptBox["a", "t"]}], "-", 
      RowBox[{"2", " ", "b"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["i", "t"]}]}], ")"}]}], "-", 
   RowBox[{"2", " ", "b", " ", "r", " ", 
    SubscriptBox["a", "t"]}], "-", 
   RowBox[{"2", " ", "r", " ", 
    SubscriptBox["a", "t"], " ", 
    SubscriptBox["i", "t"]}], "+", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    SubsuperscriptBox["a", "t", "2"]}], "+", 
   SuperscriptBox["b", "2"], "+", 
   RowBox[{"2", " ", "b", " ", 
    SubscriptBox["i", "t"]}], "+", 
   RowBox[{"\[Gamma]", " ", 
    SubsuperscriptBox["i", "t", "2"]}], "+", 
   SubsuperscriptBox["i", "t", "2"], "+", 
   SubsuperscriptBox["y", "t", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.585077431085189*^9}]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{{3.5850767119116592`*^9, 3.5850767142804127`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {"1", "0", "r", 
       RowBox[{"-", "b"}]},
      {"0", "0", "0", "0"},
      {"r", "0", 
       SuperscriptBox["r", "2"], 
       RowBox[{
        RowBox[{"-", "b"}], " ", "r"}]},
      {
       RowBox[{"-", "b"}], "0", 
       RowBox[{
        RowBox[{"-", "b"}], " ", "r"}], 
       SuperscriptBox["b", "2"]}
     }], ")"}]}], ";", " ", 
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"1", " ", "+", " ", "\[Gamma]"}], ")"}]}], ";", " ", 
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", "1"}]},
       {"0"},
       {
        RowBox[{"-", "r"}]},
       {"b"}
      }], ")"}], "]"}]}], ";", 
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["y", "t"]},
      {
       SubscriptBox["y", 
        RowBox[{"t", "-", "1"}]]},
      {
       SubscriptBox["a", "t"]},
      {"1"}
     }], ")"}]}], ";", " ", 
  RowBox[{"u", " ", "=", " ", 
   SubscriptBox["i", "t"]}], ";"}]], "Input",
 CellChangeTimes->{{3.5850781104583797`*^9, 3.585078167382558*^9}, {
  3.585078214992176*^9, 3.5850782513898993`*^9}, {3.585078315654387*^9, 
  3.585078332549657*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rt", " ", "=", " ", 
   RowBox[{"(", GridBox[{
      {
       SuperscriptBox["r", "2"], "r", "0", 
       RowBox[{
        RowBox[{"-", "b"}], " ", "r"}]},
      {"r", "1", "0", 
       RowBox[{"-", "b"}]},
      {"0", "0", "0", "0"},
      {
       RowBox[{
        RowBox[{"-", "b"}], " ", "r"}], 
       RowBox[{"-", "b", " "}], 
       RowBox[{"0", " "}], "1"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5853204359913483`*^9, 3.585320464435*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Inverse", "[", "Rt", "]"}]], "Input",
 CellChangeTimes->{{3.5853204657285843`*^9, 3.5853204687615347`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"Inverse", "::", "sing"}], "MessageName"], 
   RowBox[{
   ":", " "}], "\<\"Matrix \[NoBreak]\\!\\(TraditionalForm\\`\\((\[NoBreak] \
\\*GridBox[{{\\(r\\^2\\), \\\"r\\\", \\\"0\\\", \\(\\(\\(-b\\)\\)\\\\ r\\)}, \
{\\\"r\\\", \\\"1\\\", \\\"0\\\", \\(-b\\)}, {\\\"0\\\", \\\"0\\\", \
\\\"0\\\", \\\"0\\\"}, {\\(\\(\\(-b\\)\\)\\\\ r\\), \\(-b\\), \\\"0\\\", \
\\\"1\\\"}}, RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> \
Baseline, ColumnAlignments -> Center] \[NoBreak])\\)\\)\[NoBreak] is \
singular. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/sing\\\", ButtonNote -> \
\\\"Inverse::sing\\\"]\\)\"\>"}], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.585320469196154*^9}],

Cell[BoxData[
 FormBox[
  TemplateBox[{RowBox[{"(", "\[NoBreak]", 
      GridBox[{{
         SuperscriptBox["r", "2"], "r", "0", 
         RowBox[{
           RowBox[{"-", "b"}], " ", "r"}]}, {"r", "1", "0", 
         RowBox[{"-", "b"}]}, {"0", "0", "0", "0"}, {
         RowBox[{
           RowBox[{"-", "b"}], " ", "r"}], 
         RowBox[{"-", "b"}], "0", "1"}}, 
       GridBoxAlignment -> {
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
       GridBoxSpacings -> {"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
   "Inverse"], TraditionalForm]], "Output",
 CellChangeTimes->{3.585320469197895*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Inverse", "[", "R", "]"}]], "Input",
 CellChangeTimes->{{3.585320396267385*^9, 3.585320401390441*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"Inverse", "::", "sing"}], "MessageName"], 
   RowBox[{
   ":", " "}], "\<\"Matrix \[NoBreak]\\!\\(TraditionalForm\\`\\((\[NoBreak] \
\\*GridBox[{{\\\"1\\\", \\\"0\\\", \\\"r\\\", \\(-b\\)}, {\\\"0\\\", \
\\\"0\\\", \\\"0\\\", \\\"0\\\"}, {\\\"r\\\", \\\"0\\\", \\(r\\^2\\), \
\\(\\(\\(-b\\)\\)\\\\ r\\)}, {\\(-b\\), \\\"0\\\", \\(\\(\\(-b\\)\\)\\\\ \
r\\), \\(b\\^2\\)}}, RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> \
Baseline, ColumnAlignments -> Center] \[NoBreak])\\)\\)\[NoBreak] is \
singular. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/sing\\\", ButtonNote -> \
\\\"Inverse::sing\\\"]\\)\"\>"}], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.585320401991968*^9}],

Cell[BoxData[
 FormBox[
  TemplateBox[{RowBox[{"(", "\[NoBreak]", 
      GridBox[{{"1", "0", "r", 
         RowBox[{"-", "b"}]}, {"0", "0", "0", "0"}, {"r", "0", 
         SuperscriptBox["r", "2"], 
         RowBox[{
           RowBox[{"-", "b"}], " ", "r"}]}, {
         RowBox[{"-", "b"}], "0", 
         RowBox[{
           RowBox[{"-", "b"}], " ", "r"}], 
         SuperscriptBox["b", "2"]}}, 
       GridBoxAlignment -> {
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
       GridBoxSpacings -> {"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
   "Inverse"], TraditionalForm]], "Output",
 CellChangeTimes->{3.585320401994961*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", "x", "]"}], ".", "R", ".", "x"}], " ", "+", 
    " ", 
    RowBox[{"u", " ", "*", " ", "Q", " ", "*", " ", "u"}], " ", "+", " ", 
    RowBox[{"2", " ", "*", " ", "u", " ", "*", 
     RowBox[{"H", ".", "x"}]}]}], "]"}], " ", "-", " ", "f"}]], "Input",
 CellChangeTimes->{{3.585078255000853*^9, 3.585078289492354*^9}, {
  3.585078337427868*^9, 3.585078340491399*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.58507825839743*^9, 3.585078289703516*^9}, {
  3.5850783222899923`*^9, 3.585078340658271*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["H"], "Input",
 CellChangeTimes->{{3.585078175935439*^9, 3.585078176749157*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}]},
     {"0"},
     {
      RowBox[{"-", "r"}]},
     {"b"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.585078177018746*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", "H", "]"}]], "Input",
 CellChangeTimes->{{3.585078177969191*^9, 3.585078181389297*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "r"}], "b"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.585078181806074*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "R", "]"}]], "Input",
 CellChangeTimes->{{3.585079073474311*^9, 3.5850790781089993`*^9}}],

Cell["\<\
\\left(
\\begin{array}{cccc}
 1 & 0 & r & -b \\\\
 0 & 0 & 0 & 0 \\\\
 r & 0 & r^2 & -b r \\\\
 -b & 0 & -b r & b^2 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.585079078346382*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "H", "]"}]], "Input",
 CellChangeTimes->{{3.5850791167168427`*^9, 3.585079119059143*^9}}],

Cell["\<\
\\left(
\\begin{array}{cccc}
 -1 & 0 & -r & b \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.5850791194809713`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Problem 5.4", "Section",
 CellChangeTimes->{{3.585080762320043*^9, 3.585080763489156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"expr2", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["s", "t"], " ", "-", " ", "b"}], ")"}], "2"], " ", "+", 
     RowBox[{
      SubscriptBox["i", "t"], " ", "\[Gamma]", " ", 
      SubscriptBox["i", "t"]}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.585080790905621*^9, {3.585081842552169*^9, 3.585081859591175*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"big4", " ", "=", " ", 
   RowBox[{"Expand", "[", 
    RowBox[{"expr2", " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["s", "t"], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Lambda]", " ", 
          SubscriptBox["h", "t"]}], " ", "+", " ", 
         RowBox[{"pi", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", " ", 
             SubscriptBox["a", "t"]}], " ", "+", " ", 
            SubscriptBox["y", "t"], " ", "-", " ", 
            SubscriptBox["i", "t"]}], ")"}]}]}], ")"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.585082969765353*^9, 3.585083002603271*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", "b", " ", "pi", " ", "r", " ", 
     SubscriptBox["a", "t"]}]}], "+", 
   RowBox[{"2", " ", "\[Lambda]", " ", "pi", " ", "r", " ", 
    SubscriptBox["a", "t"], " ", 
    SubscriptBox["h", "t"]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["pi", "2"], " ", "r", " ", 
    SubscriptBox["a", "t"], " ", 
    SubscriptBox["i", "t"]}], "+", 
   RowBox[{
    SuperscriptBox["pi", "2"], " ", 
    SuperscriptBox["r", "2"], " ", 
    SubsuperscriptBox["a", "t", "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["pi", "2"], " ", "r", " ", 
    SubscriptBox["a", "t"], " ", 
    SubscriptBox["y", "t"]}], "+", 
   SuperscriptBox["b", "2"], "-", 
   RowBox[{"2", " ", "b", " ", "\[Lambda]", " ", 
    SubscriptBox["h", "t"]}], "+", 
   RowBox[{"2", " ", "b", " ", "pi", " ", 
    SubscriptBox["i", "t"]}], "-", 
   RowBox[{"2", " ", "b", " ", "pi", " ", 
    SubscriptBox["y", "t"]}], "-", 
   RowBox[{"2", " ", "\[Lambda]", " ", "pi", " ", 
    SubscriptBox["h", "t"], " ", 
    SubscriptBox["i", "t"]}], "+", 
   RowBox[{"2", " ", "\[Lambda]", " ", "pi", " ", 
    SubscriptBox["h", "t"], " ", 
    SubscriptBox["y", "t"]}], "+", 
   RowBox[{
    SuperscriptBox["\[Lambda]", "2"], " ", 
    SubsuperscriptBox["h", "t", "2"]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["pi", "2"], " ", 
    SubscriptBox["i", "t"], " ", 
    SubscriptBox["y", "t"]}], "+", 
   RowBox[{
    SuperscriptBox["pi", "2"], " ", 
    SubsuperscriptBox["i", "t", "2"]}], "+", 
   RowBox[{"\[Gamma]", " ", 
    SubsuperscriptBox["i", "t", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["pi", "2"], " ", 
    SubsuperscriptBox["y", "t", "2"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.585082982433125*^9, 3.585083003045121*^9}, 
   3.5855370744845867`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Build the R matrix", "Subsection",
 CellChangeTimes->{{3.585083118862907*^9, 3.585083121414156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R4", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"5", ",", " ", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5850830508431187`*^9, 3.585083071112482*^9}, {
  3.585083109207797*^9, 3.58508311149529*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Do", " ", "first", " ", "row", " ", "and", " ", "Column", " ", 
    SubscriptBox["a", "t"], " ", "stuff"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"big4", ",", " ", 
       SubscriptBox["a", "t"], ",", " ", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"R4", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"big4", ",", " ", 
         RowBox[{
          SubscriptBox["y", "t"], " ", 
          SubscriptBox["a", "t"]}], ",", " ", "1"}], "]"}], " ", "/", " ", 
       "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "3"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"R4", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"big4", ",", " ", 
         RowBox[{
          SubscriptBox["y", 
           RowBox[{"t", "-", "1"}]], " ", 
          SubscriptBox["a", "t"]}], ",", " ", "1"}], "]"}], " ", "/", " ", 
       "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "4"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"R4", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"big4", ",", " ", 
         RowBox[{
          SubscriptBox["a", "t"], " ", 
          SubscriptBox["h", "t"]}], ",", " ", "1"}], "]"}], " ", "/", 
       "2"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Do", " ", "2", "nd", " ", 
     RowBox[{"row", "/", "columns"}], " ", 
     SubscriptBox["y", "t"], " ", "stuff"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"big4", ",", " ", 
       SubscriptBox["y", "t"], ",", " ", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "4"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"R4", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", " ", "2"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"big4", ",", " ", 
         RowBox[{
          SubscriptBox["y", "t"], " ", 
          SubscriptBox["h", "t"]}], ",", " ", "1"}], "]"}], " ", "/", " ", 
       "2"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Do", " ", "4"}], ",", " ", 
     RowBox[{"4", " ", "entry", " ", 
      SubscriptBox["h", "t"], " ", 
      SubscriptBox["h", "t"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", " ", "4"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"big4", ",", " ", 
       SubscriptBox["h", "t"], ",", " ", "2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "I", " ", "have", " ", "do", " ", "to", " ", "the", " ", "last", " ", 
     "row", " ", "and", " ", "column", " ", "by", " ", "hand"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"big4", ",", " ", 
     SubscriptBox["y", "t"], ",", " ", "1"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"big4", ",", " ", 
     SubscriptBox["a", "t"], ",", " ", "1"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"big4", ",", " ", 
     SubscriptBox["h", "t"], ",", " ", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.585083083497604*^9, 3.585083138302791*^9}, {
  3.585083196900755*^9, 3.5850833172834063`*^9}, {3.5850833686816893`*^9, 
  3.5850833889986134`*^9}, {3.5850835106748943`*^9, 3.585083631750787*^9}, {
  3.585083677688201*^9, 3.5850836932470284`*^9}, {3.585083723387896*^9, 
  3.585083794281673*^9}, {3.585083867679668*^9, 3.585083880499526*^9}, {
  3.585536965442258*^9, 3.585537064237501*^9}, {3.58553728917426*^9, 
  3.585537306372099*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"2", " ", 
    SuperscriptBox["pi", "2"], " ", "r", " ", 
    SubscriptBox["a", "t"]}], "-", 
   RowBox[{"2", " ", "b", " ", "pi"}], "+", 
   RowBox[{"2", " ", "\[Lambda]", " ", "pi", " ", 
    SubscriptBox["h", "t"]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["pi", "2"], " ", 
    SubscriptBox["i", "t"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.585083784943953*^9, 3.585083794445428*^9}, 
   3.58508388137366*^9, 3.5855371311036367`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", "b", " ", "pi", " ", "r"}]}], "+", 
   RowBox[{"2", " ", "\[Lambda]", " ", "pi", " ", "r", " ", 
    SubscriptBox["h", "t"]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["pi", "2"], " ", "r", " ", 
    SubscriptBox["i", "t"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["pi", "2"], " ", "r", " ", 
    SubscriptBox["y", "t"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.585083784943953*^9, 3.585083794445428*^9}, 
   3.58508388137366*^9, 3.585537131139524*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"2", " ", "\[Lambda]", " ", "pi", " ", "r", " ", 
    SubscriptBox["a", "t"]}], "-", 
   RowBox[{"2", " ", "b", " ", "\[Lambda]"}], "-", 
   RowBox[{"2", " ", "\[Lambda]", " ", "pi", " ", 
    SubscriptBox["i", "t"]}], "+", 
   RowBox[{"2", " ", "\[Lambda]", " ", "pi", " ", 
    SubscriptBox["y", "t"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.585083784943953*^9, 3.585083794445428*^9}, 
   3.58508388137366*^9, 3.585537131140993*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Only", " ", 
      SubscriptBox["y", "t"], "term", " ", "with", " ", "out", " ", "another",
       " ", "state", " ", "var", " ", "is"}], " ", "-", 
     RowBox[{"2", " ", "b", " ", "pi"}]}], " ", "\[Rule]", " ", 
    RowBox[{
     RowBox[{"-", "b"}], " ", "pi"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "5"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"R4", "[", 
       RowBox[{"[", 
        RowBox[{"5", ",", " ", "2"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "b"}], " ", "pi"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Only", " ", 
       SubscriptBox["a", "t"], "term", " ", "with", " ", "out", " ", 
       "another", " ", "state", " ", "var", " ", "is"}], " ", "-", 
      RowBox[{"2", " ", "b", " ", "pi", " ", "r"}]}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"-", "b"}], " ", "pi", " ", "r"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"R4", "[", 
       RowBox[{"[", 
        RowBox[{"5", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "b"}], " ", "pi", " ", "r"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Only", " ", 
       SubscriptBox["h", "t"], "term", " ", "with", " ", "out", " ", 
       "another", " ", "state", " ", "var", " ", "is"}], " ", "-", 
      RowBox[{"2", " ", "b", " ", "\[Lambda]"}]}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"-", "b"}], " ", "\[Lambda]"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", " ", "5"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"R4", "[", 
       RowBox[{"[", 
        RowBox[{"5", ",", " ", "4"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "b"}], " ", "\[Lambda]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Only", " ", "term", " ", "with", " ", "only", " ", "constants", " ", 
     "is", " ", 
     SuperscriptBox["b", "2"]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R4", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", " ", "5"}], "]"}], "]"}], " ", "=", " ", 
     SuperscriptBox["b", "2"]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.585083830000146*^9, 3.585084011394761*^9}, {
  3.5850840857943163`*^9, 3.585084103792561*^9}, {3.585537093649763*^9, 
  3.585537122509817*^9}}],

Cell[CellGroupData[{

Cell[BoxData["R4"], "Input",
 CellChangeTimes->{{3.585083297609507*^9, 3.585083297865142*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["pi", "2"], " ", 
       SuperscriptBox["r", "2"]}], 
      RowBox[{
       SuperscriptBox["pi", "2"], " ", "r"}], "0", 
      RowBox[{"pi", " ", "r", " ", "\[Lambda]"}], 
      RowBox[{
       RowBox[{"-", "b"}], " ", "pi", " ", "r"}]},
     {
      RowBox[{
       SuperscriptBox["pi", "2"], " ", "r"}], 
      SuperscriptBox["pi", "2"], "0", 
      RowBox[{"pi", " ", "\[Lambda]"}], 
      RowBox[{
       RowBox[{"-", "b"}], " ", "pi"}]},
     {"0", "0", "0", "0", "0"},
     {
      RowBox[{"pi", " ", "r", " ", "\[Lambda]"}], 
      RowBox[{"pi", " ", "\[Lambda]"}], "0", 
      SuperscriptBox["\[Lambda]", "2"], 
      RowBox[{
       RowBox[{"-", "b"}], " ", "\[Lambda]"}]},
     {
      RowBox[{
       RowBox[{"-", "b"}], " ", "pi", " ", "r"}], 
      RowBox[{
       RowBox[{"-", "b"}], " ", "pi"}], "0", 
      RowBox[{
       RowBox[{"-", "b"}], " ", "\[Lambda]"}], 
      SuperscriptBox["b", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.585083298541814*^9, 3.5850833188450527`*^9}, 
   3.5850837392854557`*^9, 3.585083995706005*^9, 3.585084104955126*^9, {
   3.5855371283692007`*^9, 3.585537133869966*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "R4", "]"}]], "Input",
 CellChangeTimes->{{3.585090091565258*^9, 3.585090104920192*^9}}],

Cell["\<\
\\left(
\\begin{array}{ccccc}
 \\pi ^2 r^2 & \\pi ^2 r & 0 & \\pi  r \\lambda  & -b \\pi  r \\\\
 \\pi ^2 r & \\pi ^2 & 0 & \\pi  \\lambda  & -b \\pi  \\\\
 0 & 0 & 0 & 0 & 0 \\\\
 \\pi  r \\lambda  & \\pi  \\lambda  & 0 & \\lambda ^2 & -b \\lambda  \\\\
 -b \\pi  r & -b \\pi  & 0 & -b \\lambda  & b^2 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{
  3.5850901090509768`*^9, {3.5855371570517073`*^9, 3.585537161022868*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Build the H matrix", "Subsection",
 CellChangeTimes->{{3.5850841186559*^9, 3.585084121486602*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"H4", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H4", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"big4", ",", " ", 
      RowBox[{
       SubscriptBox["i", "t"], 
       SubscriptBox["a", "t"]}], ",", " ", "1"}], "]"}], " ", "/", " ", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H4", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", " ", "2"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"big4", ",", " ", 
      RowBox[{
       SubscriptBox["i", "t"], 
       SubscriptBox["y", "t"]}], ",", " ", "1"}], "]"}], " ", "/", " ", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H4", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", " ", "3"}], "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"big4", ",", " ", 
      RowBox[{
       SubscriptBox["i", "t"], 
       SubscriptBox["y", 
        RowBox[{"t", "-", "1"}]]}], ",", " ", "1"}], "]"}], " ", "/", " ", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"H4", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "4"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"big4", ",", " ", 
       RowBox[{
        SubscriptBox["i", "t"], 
        SubscriptBox["h", "t"]}], ",", " ", "1"}], "]"}], " ", "/", " ", 
     "2"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "I", " ", "need", " ", "to", " ", "do", " ", "the", " ", "constant", " ", 
    "term", " ", "by", " ", "hand"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Coefficient", "[", 
  RowBox[{"big4", ",", " ", 
   SubscriptBox["i", "t"], ",", " ", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.585084124757098*^9, 3.585084249134408*^9}, {
  3.585537200119357*^9, 3.585537211637909*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", 
     SuperscriptBox["pi", "2"], " ", "r", " ", 
     SubscriptBox["a", "t"]}]}], "+", 
   RowBox[{"2", " ", "b", " ", "pi"}], "-", 
   RowBox[{"2", " ", "\[Lambda]", " ", "pi", " ", 
    SubscriptBox["h", "t"]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["pi", "2"], " ", 
    SubscriptBox["y", "t"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.585084250274974*^9, 3.585537216364065*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Only", " ", 
     SubscriptBox["h", "t"], "term", " ", "with", " ", "out", " ", "another", 
     " ", "state", " ", "var", " ", "is", " ", "2", " ", "b", " ", "\[Pi]"}], 
    " ", "\[Rule]", " ", 
    RowBox[{"b", " ", "\[Lambda]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"H4", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{"b", " ", "\[Pi]"}]}], " ", ";"}]}]], "Input",
 CellChangeTimes->{{3.585084257424678*^9, 3.5850842975298157`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["H4"], "Input",
 CellChangeTimes->{{3.5850842999154587`*^9, 3.5850843000821333`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["pi", "2"]}], " ", "r"}], 
      RowBox[{"-", 
       SuperscriptBox["pi", "2"]}], "0", 
      RowBox[{
       RowBox[{"-", "pi"}], " ", "\[Lambda]"}], 
      RowBox[{"b", " ", "\[Pi]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.585084300599043*^9, 3.5855372225317917`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "H4", "]"}]], "Input",
 CellChangeTimes->{{3.585090145740181*^9, 3.585090149006901*^9}}],

Cell["\<\
\\left(
\\begin{array}{ccccc}
 -\\pi ^2 r & -\\pi ^2 & 0 & -\\pi  \\lambda  & b \\pi  \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.585090149306466*^9, 3.5855372513741293`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Build Q matrix", "Subsection",
 CellChangeTimes->{{3.585084328274859*^9, 3.585084333136815*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Q", " ", "matrix", " ", "is", " ", "just", " ", "the", " ", "powers", " ",
     "of", " ", 
    SuperscriptBox["i", "2"]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Q4", " ", "=", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"big4", ",", " ", 
      SubscriptBox["i", "t"], ",", " ", "2"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.585084334301652*^9, 3.5850843648252287`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["Q4"], "Input",
 CellChangeTimes->{{3.585090170826683*^9, 3.5850901710531797`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\[Gamma]", "+", 
   SuperscriptBox["pi", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.5850901712270823`*^9, 3.585537266820601*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "Q4", "]"}]], "Input",
 CellChangeTimes->{{3.5850901743771677`*^9, 3.5850901779512453`*^9}}],

Cell["\\gamma +\\pi ^2", "Output",
 CellChangeTimes->{3.5850901783766823`*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{718, 856},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 133, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[715, 26, 98, 1, 80, "Section"],
Cell[816, 29, 417, 12, 35, "Input"],
Cell[CellGroupData[{
Cell[1258, 45, 802, 24, 46, "Input"],
Cell[2063, 71, 439, 13, 23, "Print"],
Cell[2505, 86, 161, 2, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2703, 93, 614, 15, 28, "Input"],
Cell[3320, 110, 1093, 29, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4450, 144, 128, 2, 28, "Input"],
Cell[4581, 148, 173, 4, 29, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4791, 157, 177, 4, 28, "Input"],
Cell[4971, 163, 903, 27, 34, "Output"]
}, Open  ]],
Cell[5889, 193, 97, 1, 28, "Input"],
Cell[5989, 196, 1257, 45, 85, "Input"],
Cell[7249, 243, 499, 17, 83, "Input"],
Cell[CellGroupData[{
Cell[7773, 264, 131, 2, 28, "Input"],
Cell[7907, 268, 846, 16, 72, "Message"],
Cell[8756, 286, 908, 22, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9701, 313, 126, 2, 28, "Input"],
Cell[9830, 317, 848, 16, 76, "Message"],
Cell[10681, 335, 939, 23, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11657, 363, 471, 11, 48, "Input"],
Cell[12131, 376, 648, 17, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12816, 398, 93, 1, 48, "Input"],
Cell[12912, 401, 654, 21, 144, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13603, 427, 128, 2, 48, "Input"],
Cell[13734, 431, 633, 18, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14404, 454, 128, 2, 48, "Input"],
Cell[14535, 458, 210, 10, 223, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14782, 473, 128, 2, 48, "Input"],
Cell[14913, 477, 142, 7, 148, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[15104, 490, 96, 1, 50, "Section"],
Cell[15203, 493, 441, 13, 35, "Input"],
Cell[CellGroupData[{
Cell[15669, 510, 708, 20, 46, "Input"],
Cell[16380, 532, 1820, 50, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18237, 587, 106, 1, 44, "Subsection"],
Cell[18346, 590, 323, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[18694, 602, 4830, 129, 301, "Input"],
Cell[23527, 733, 506, 13, 33, "Output"],
Cell[24036, 748, 554, 14, 33, "Output"],
Cell[24593, 764, 495, 11, 28, "Output"]
}, Open  ]],
Cell[25103, 778, 2910, 81, 202, "Input"],
Cell[CellGroupData[{
Cell[28038, 863, 94, 1, 28, "Input"],
Cell[28135, 866, 1669, 48, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29841, 919, 127, 2, 28, "Input"],
Cell[29971, 923, 450, 12, 160, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[30470, 941, 104, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[30599, 946, 2196, 66, 148, "Input"],
Cell[32798, 1014, 477, 13, 33, "Output"]
}, Open  ]],
Cell[33290, 1030, 602, 15, 46, "Input"],
Cell[CellGroupData[{
Cell[33917, 1049, 98, 1, 28, "Input"],
Cell[34018, 1052, 841, 24, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34896, 1081, 127, 2, 28, "Input"],
Cell[35026, 1085, 204, 7, 100, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[35279, 1098, 102, 1, 36, "Subsection"],
Cell[35384, 1101, 474, 12, 49, "Input"],
Cell[CellGroupData[{
Cell[35883, 1117, 96, 1, 28, "Input"],
Cell[35982, 1120, 178, 4, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36197, 1129, 131, 2, 28, "Input"],
Cell[36331, 1133, 78, 1, 29, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
